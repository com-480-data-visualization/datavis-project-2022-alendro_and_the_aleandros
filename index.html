<!DOCTYPE html>
<html>
    <head>
        <link rel = "stylesheet" href = "css/indexStyle.css">

        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
        integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
        crossorigin=""/>

        <!-- Make sure you put this AFTER Leaflet's CSS -->
        <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
        integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
        crossorigin=""></script>
        <link rel="stylesheet" href="node_modules/leaflet.markercluster/dist/MarkerCluster.css">
        <link rel="stylesheet" href="node_modules/leaflet.markercluster/dist/MarkerCluster.Default.css">
        <script src="node_modules/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
        
        
    </head>
    <div class="header">
        <a href="#default" class="logo">DataViz</a>
        <div class="header-right">
            <a class="active" href="#home">Home</a>
            <a href="#contact">Contact</a>
            <a href="#about">About</a>
        </div>
    </div> 
    <body>
        <div id="map"></div>
        <script src="http://d3js.org/d3.v7.min.js" charset="utf-8"></script>
        <script src="https://d3js.org/d3-queue.v3.min.js"></script>
        <script>
            var map = L.map('map').setView([51.505, -0.09], 13);

            L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,
                id: 'mapbox/streets-v11',
                tileSize: 512,
                zoomOffset: -1,
                accessToken: 'pk.eyJ1IjoicXVlbnRpbm11bGxlciIsImEiOiJjbDJoaHhuN3MwZHpjM2lwaG8zeTYxMGxjIn0.k47skeSjpBY-QnUQ7RvuJw'
            }).addTo(map);

            var markers = L.markerClusterGroup()
            d3.csv("https://raw.githubusercontent.com/com-480-data-visualization/datavis-project-2022-alendro_and_the_aleandros/master/open_pubs.csv").then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    // The condition below is there to take care of some lat/lon being /N and /N.
                    if(data[i].latitude != data[i].longitude) {
                        var marker = L.marker([data[i].latitude, data[i].longitude]);
                        marker.bindPopup(`Name: ${data[i].name}`).openPopup();
                        markers.addLayer(marker);
                    }
                }
                map.addLayer(markers);
            });
            

        </script>
    </body>
</html>